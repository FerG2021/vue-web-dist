import{_ as z,r as i,d as N,o as s,c as f,a as t,w as l,e as U,f as C,g as _,t as v,i as G,E as x,F as k,h as T,b as p}from"./index.ec5771ba.js";const I={data(){return{id:null,loading:!1,datos:null}},methods:{abrir(o){this.loading=!0,this.id=null,this.id=o,this.datos=null,this.$refs.modal.abrir(),this.getDatos()},cerrar(){this.$refs.modal.cerrar()},async getDatos(){await this.axios.get("/api/producto/obtenerDatos/"+this.id).then(o=>{const e=o;console.log(e),e!=null?(this.datos=e.data,console.log(this.datos),this.loading=!1):this.cerrar()})}}},L={key:0},F={key:0},j=_("Activo"),$={key:1},q=_("Inactivo");function H(o,e,y,S,r,c){const m=i("el-descriptions-item"),d=i("el-tag"),h=i("el-descriptions"),b=i("modal"),g=N("loading");return s(),f("div",null,[t(b,{ref:"modal",titulo:"Datos del producto","impedir-close":o.impedirClose},{default:l(()=>[U((s(),C(h,{title:"Informaci\xF3n del producto",direction:"vertical",column:4,size:o.size,border:""},{default:l(()=>[r.datos!=null?(s(),f("div",L,[t(m,{label:"C\xF3digo"},{default:l(()=>[_(v(r.datos.producto_codigo),1)]),_:1}),t(m,{label:"Nombre"},{default:l(()=>[_(v(r.datos.producto_nombre),1)]),_:1}),t(m,{label:"Rubro"},{default:l(()=>[_(v(r.datos.rubro.rubro_nombre),1)]),_:1}),t(m,{label:"Un. de medida"},{default:l(()=>[_(v(r.datos.producto_unidad),1)]),_:1}),t(m,{label:"Estado del producto"},{default:l(()=>[r.datos.producto_activo==1?(s(),f("span",F,[t(d,{size:"small",type:"success"},{default:l(()=>[j]),_:1})])):(s(),f("span",$,[t(d,{size:"small",type:"danger"},{default:l(()=>[q]),_:1})]))]),_:1}),t(m,{label:"Fecha de ult. compra"},{default:l(()=>[_(v(r.datos.producto_fpuc.split("-").reverse().join("/")),1)]),_:1}),t(m,{label:"Precio de ult. compra"},{default:l(()=>[_(" $ "+v(r.datos.producto_puc),1)]),_:1})])):G("",!0)]),_:1},8,["size"])),[[g,r.loading]])]),_:1},8,["impedir-close"])])}var J=z(I,[["render",H]]);const K={data(){return{url:"http://localhost:8000/api/articulo/",form:{nombre:null,precio:null,stock:null,unidadMedida:null,categoria:null},categoriasSelect:[],unidadMedidaSelect:[]}},created(){this.categoriaObtenerTodosSelect(),this.unidadMedidaObtenerTodosSelect()},methods:{abrir(){this.form.nombre=null,this.form.precio=null,this.form.stock=null,this.form.unidadMedida=null,this.form.categoria=null,this.$refs.modal.abrir()},cerrar(){this.$refs.modal.cerrar()},async categoriaObtenerTodosSelect(){await this.axios.get(this.base_url+"/categoria/obtenerTodosSelect").then(o=>{this.categoriasSelect=o.data,console.log(this.categoriasSelect)})},async unidadMedidaObtenerTodosSelect(){await this.axios.get(this.base_url+"/unidad-medida/obtenerTodosSelect").then(o=>{this.unidadMedidaSelect=o.data,console.log(this.categoriasSelect)})},onSubmit(){let o={descripcion:this.form.nombre,precio:this.form.precio,stock:this.form.stock,idUnidadMedida:this.form.unidadMedida,idCategoria:this.form.categoria};this.axios.post(this.base_url+"/articulo/crear",o).then(e=>{x({type:"success",message:"\xA1Producto a\xF1adido con \xE9xito!"}),this.$emit("actualizarTabla"),this.cerrar()})},deshabilitarBtnGuardar(){return this.form.nombre==null||this.form.nombre==""||this.form.precio==null||this.form.precio==0||this.form.precio==""||this.form.stock==null||this.form.stock==0||this.form.stock==""||this.form.categoria==null||this.form.categoria==0||this.form.categoria==""}}},Q=_(" Guardar");function W(o,e,y,S,r,c){const m=i("el-input"),d=i("el-form-item"),h=i("el-input-number"),b=i("el-option"),g=i("el-select"),w=i("el-form"),M=i("el-button"),V=i("modal");return s(),f("div",null,[t(V,{ref:"modal",titulo:"Nuevo producto","impedir-close":o.impedirClose},{footer:l(()=>[t(M,{type:"primary",onClick:e[5]||(e[5]=a=>c.onSubmit()),disabled:c.deshabilitarBtnGuardar()},{default:l(()=>[Q]),_:1},8,["disabled"])]),default:l(()=>[t(w,{"label-width":"120px"},{default:l(()=>[t(d,{label:"Nombre",prop:"nombre"},{default:l(()=>[t(m,{modelValue:r.form.nombre,"onUpdate:modelValue":e[0]||(e[0]=a=>r.form.nombre=a)},null,8,["modelValue"])]),_:1}),t(d,{label:"Precio",prop:"precio"},{default:l(()=>[t(h,{modelValue:r.form.precio,"onUpdate:modelValue":e[1]||(e[1]=a=>r.form.precio=a),step:.1,controls:!1,style:{width:"100%",align:"left"}},null,8,["modelValue","step"])]),_:1}),t(d,{label:"Stock",prop:"stock"},{default:l(()=>[t(h,{modelValue:r.form.stock,"onUpdate:modelValue":e[2]||(e[2]=a=>r.form.stock=a),controls:!1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(d,{label:"Unid. de medida",prop:"unidadMedida"},{default:l(()=>[t(g,{modelValue:r.form.unidadMedida,"onUpdate:modelValue":e[3]||(e[3]=a=>r.form.unidadMedida=a),class:"m-2",placeholder:"Seleccione una unidad de medida",style:{width:"100%"}},{default:l(()=>[(s(!0),f(k,null,T(r.unidadMedidaSelect,a=>(s(),C(b,{key:a.id,label:a.nombre,value:a.id,style:{width:"100%"}},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"Categoria",prop:"categoria"},{default:l(()=>[t(g,{modelValue:r.form.categoria,"onUpdate:modelValue":e[4]||(e[4]=a=>r.form.categoria=a),class:"m-2",placeholder:"Seleccione una categoria",style:{width:"100%"}},{default:l(()=>[(s(!0),f(k,null,T(r.categoriasSelect,a=>(s(),C(b,{key:a.id,label:a.nombre,value:a.id,style:{width:"100%"}},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["impedir-close"])])}var X=z(K,[["render",W]]);const Y={data(){return{url:"http://localhost:8000/api/articulo/",form:{nombre:null,precio:null,stock:null,unidadMedida:null,idUnidadMedida:null,categoria:null,idCategoria:null},id:null,articulos:[],loading:!1}},methods:{abrir(o){this.loading=!0,this.id=null,this.id=o,this.$refs.modal.abrir(),this.form.nombre=null,this.form.precio=null,this.form.stock=null,this.form.unidadMedida=null,this.form.idUnidadMedida=null,this.form.categoria=null,this.form.idCategoria=null,this.getDatos(),this.categoriaObtenerTodosSelect(),this.unidadMedidaObtenerTodosSelect()},cerrar(){this.$refs.modal.cerrar()},async getDatos(){await this.axios.get(this.base_url+"/articulo/obtenerDatos/"+this.id).then(o=>{const e=o.data;console.log(e),e!=null?(this.form.nombre=e.descripcion,this.form.precio=e.precio,this.form.stock=e.stock,this.form.unidadMedida=e.unidadMedida.nombre,this.form.idUnidadMedida=e.unidadMedida.id,this.form.categoria=e.categoria.nombre,this.form.idCategoria=e.categoria.id,this.loading=!1):this.cerrar()})},async categoriaObtenerTodosSelect(){await this.axios.get(this.base_url+"/categoria/obtenerTodosSelect").then(o=>{this.categoriasSelect=o.data,console.log(this.categoriasSelect)})},async unidadMedidaObtenerTodosSelect(){await this.axios.get(this.base_url+"/unidad-medida/obtenerTodosSelect").then(o=>{this.unidadMedidaSelect=o.data,console.log(this.categoriasSelect)})},cambiarValorIDUnMed(){this.form.idUnidadMedida=this.form.unidadMedida},cambiarValorIDCategoria(){this.form.idCategoria=this.form.categoria},onSubmit(){let o={id:this.id,descripcion:this.form.nombre,precio:this.form.precio,stock:this.form.stock,idCategoria:this.form.idCategoria,idUnidadMedida:this.form.idUnidadMedida};this.axios.put(this.base_url+"/articulo/actualizar/"+this.id,o).then(e=>{x({type:"success",message:"\xA1Producto modificado con \xE9xito!"}),this.$emit("actualizarTabla"),this.cerrar()}).catch(e=>{console.log(e)})},deshabilitarBtnGuardar(){return this.form.nombre==null||this.form.nombre==""||this.form.precio==null||this.form.precio==0||this.form.precio==""||this.form.stock==null||this.form.stock==0||this.form.stock==""}}},Z=_("Guardar");function ee(o,e,y,S,r,c){const m=i("el-input"),d=i("el-form-item"),h=i("el-input-number"),b=i("el-option"),g=i("el-select"),w=i("el-form"),M=i("el-button"),V=i("modal"),a=N("loading");return s(),f("div",null,[t(V,{ref:"modal",titulo:"Modificar producto","impedir-close":o.impedirClose},{footer:l(()=>[t(M,{type:"primary",onClick:e[7]||(e[7]=n=>c.onSubmit()),disabled:c.deshabilitarBtnGuardar()},{default:l(()=>[Z]),_:1},8,["disabled"])]),default:l(()=>[U((s(),C(w,{"label-width":"120px",rules:o.formRules},{default:l(()=>[t(d,{label:"Nombre",prop:"nombre"},{default:l(()=>[t(m,{modelValue:r.form.nombre,"onUpdate:modelValue":e[0]||(e[0]=n=>r.form.nombre=n)},null,8,["modelValue"])]),_:1}),t(d,{label:"Precio",prop:"precio"},{default:l(()=>[t(h,{modelValue:r.form.precio,"onUpdate:modelValue":e[1]||(e[1]=n=>r.form.precio=n),step:.1,controls:!1,style:{width:"100%",align:"left"}},null,8,["modelValue","step"])]),_:1}),t(d,{label:"Stock",prop:"stock"},{default:l(()=>[t(h,{modelValue:r.form.stock,"onUpdate:modelValue":e[2]||(e[2]=n=>r.form.stock=n),controls:!1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(d,{label:"Unid. de medida",prop:"unidadMedida"},{default:l(()=>[t(g,{modelValue:r.form.unidadMedida,"onUpdate:modelValue":e[3]||(e[3]=n=>r.form.unidadMedida=n),class:"m-2",placeholder:"Seleccione una unidad de medida",style:{width:"100%"},onChange:e[4]||(e[4]=n=>c.cambiarValorIDUnMed())},{default:l(()=>[(s(!0),f(k,null,T(o.unidadMedidaSelect,n=>(s(),C(b,{key:n.id,label:n.nombre,value:n.id,style:{width:"100%"}},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(d,{label:"Categoria",prop:"categoria"},{default:l(()=>[t(g,{modelValue:r.form.categoria,"onUpdate:modelValue":e[5]||(e[5]=n=>r.form.categoria=n),class:"m-2",placeholder:"Seleccione una categoria",style:{width:"100%"},onChange:e[6]||(e[6]=n=>c.cambiarValorIDCategoria())},{default:l(()=>[(s(!0),f(k,null,T(o.categoriasSelect,n=>(s(),C(b,{key:n.id,label:n.nombre,value:n.id,style:{width:"100%"}},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["rules"])),[[a,r.loading]])]),_:1},8,["impedir-close"])])}var oe=z(Y,[["render",ee]]);const te={data(){return{form:{nombre:null,precio:null,stock:null},id:null,articulos:[]}},methods:{abrir(o){this.id=null,this.$refs.modal.abrir(),this.id=o},cerrar(){this.$refs.modal.cerrar()},async eliminar(){await this.axios.delete(this.base_url+"/articulo/eliminar/"+this.id).then(o=>{x({message:"Producto eliminado con \xE9xito",type:"success"}),this.$emit("actualizarTabla"),this.cerrar()})}}},le=p("h3",null,"\xBFDesea eliminar el producto?",-1),re={style:{float:"right"}},ie=_(" Cancelar "),ae=_(" Confirmar ");function ne(o,e,y,S,r,c){const m=i("el-button"),d=i("modal");return s(),f("div",null,[t(d,{ref:"modal",titulo:"Eliminar producto","impedir-close":o.impedirClose},{default:l(()=>[p("div",null,[le,p("div",re,[t(m,{type:"danger",onClick:e[0]||(e[0]=h=>c.cerrar())},{default:l(()=>[ie]),_:1}),t(m,{type:"primary",onClick:e[1]||(e[1]=h=>c.eliminar())},{default:l(()=>[ae]),_:1})])])]),_:1},8,["impedir-close"])])}var se=z(te,[["render",ne]]);const de={components:{ModalVer:J,ModalNuevo:X,ModalModificar:oe,ModalEliminar:se},data(){return{productos:[],productosNuevo:[],paginas:{},loading:!1,pageSize:20,currentPage:1,filtroNombre:"",filtroCodigo:null,rubrosSelect:[],filtroRubro:""}},mounted(){this.obtenerTodos(),this.obtenerTodosRubro()},watch:{filtroNombre(o){o==""?this.productosNuevo=this.productos:this.productosNuevo=this.buscarNombre(o)},filtroCodigo(o){o==null?this.productosNuevo=this.productos:this.productosNuevo=this.buscarCodigo(o)},filtroRubro(o){o==""?this.productosNuevo=this.productos:this.productosNuevo=this.buscarRubro(o)}},methods:{async obtenerTodos(){this.loading=!0,await this.axios.get("/api/producto/obtenerTodos").then(o=>{this.productos=this.productosNuevo=o.data.datos,this.paginas=o.data.pagina}),this.loading=!1},async obtenerTodosRubro(){await this.axios.get("/api/rubro/obtenerTodosSelect").then(o=>{this.rubrosSelect=o.data})},handleCurrentChange:function(o){this.$data.currentPage=o},handleSizeChange:function(o){this.$data.pageSize=o},buscarNombre(o){return this.productos.filter(e=>{let y=e.producto_nombre.toLowerCase(),S=o.toLowerCase();if(y.includes(S))return e})},buscarCodigo(o){return this.productos.filter(e=>{let y=e.producto_codigo.toString(),S=o.toString();if(y.includes(S))return e})},buscarRubro(o){return this.productos.filter(e=>{if(e.rubro_id==o)return e})}}},ue=p("h1",null,"Productos",-1),ce={class:"demo-collapse"},me=p("h4",{style:{color:"#95989e"}},[p("span",{class:"material-icons"},"manage_search")],-1),pe={class:"contenedor-tabla",style:{"margin-top":"10px"}},fe=p("span",{class:"material-icons"},"visibility",-1),_e={class:"contenedor-paginator"};function he(o,e,y,S,r,c){const m=i("el-input"),d=i("el-col"),h=i("el-option"),b=i("el-select"),g=i("el-row"),w=i("el-collapse-item"),M=i("el-collapse"),V=i("el-table-column"),a=i("el-button"),n=i("el-table"),D=i("el-pagination"),P=i("el-card"),R=i("modal-ver"),B=i("modal-nuevo"),A=i("modal-modificar"),O=i("modal-eliminar"),E=N("loading");return s(),f(k,null,[p("main",null,[t(P,null,{header:l(()=>[ue]),default:l(()=>[p("div",ce,[t(M,{modelValue:o.activeNames,"onUpdate:modelValue":e[3]||(e[3]=u=>o.activeNames=u),onChange:o.handleChange},{default:l(()=>[t(w,{title:"Filtros",name:"1"},{title:l(()=>[me]),default:l(()=>[p("div",null,[t(g,{gutter:10},{default:l(()=>[t(d,{span:8},{default:l(()=>[t(m,{modelValue:r.filtroNombre,"onUpdate:modelValue":e[0]||(e[0]=u=>r.filtroNombre=u),placeholder:"Buscar por nombre",clearable:""},null,8,["modelValue"])]),_:1}),t(d,{span:8},{default:l(()=>[t(m,{modelValue:r.filtroCodigo,"onUpdate:modelValue":e[1]||(e[1]=u=>r.filtroCodigo=u),placeholder:"Buscar por c\xF3digo",clearable:"",controls:!1,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(d,{span:8},{default:l(()=>[t(b,{modelValue:r.filtroRubro,"onUpdate:modelValue":e[2]||(e[2]=u=>r.filtroRubro=u),placeholder:"Seleccionar por rubro",filterable:"",clearable:"",style:{width:"100%"}},{default:l(()=>[(s(!0),f(k,null,T(r.rubrosSelect,u=>(s(),C(h,{key:u.rubro_id,label:u.rubro_nombre,value:u.rubro_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1})]),_:1},8,["modelValue","onChange"])]),p("div",pe,[U((s(),C(n,{data:r.productosNuevo.slice((r.currentPage-1)*r.pageSize,r.currentPage*r.pageSize),fixed:""},{default:l(()=>[t(V,{label:"Nombre",prop:"descripcion"},{default:l(u=>[p("span",null,v(u.row.producto_nombre),1)]),_:1}),t(V,{label:"C\xF3digo",prop:"codigo"},{default:l(u=>[p("span",null,v(u.row.producto_codigo),1)]),_:1}),t(V,{label:"Rubro",prop:"rubro"},{default:l(u=>[p("span",null,v(u.row.rubro.rubro_nombre),1)]),_:1}),t(V,{label:"Ver",prop:"ver","header-align":"center",align:"center",width:"75px"},{default:l(u=>[t(a,{type:"primary",circle:"",onClick:be=>o.$refs.modalVer.abrir(u.row.producto_id)},{default:l(()=>[fe]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[E,r.loading]]),p("div",_e,[t(D,{layout:"prev, pager, next, sizes, total, jumper","page-sizes":[10,20,30],"page-size":r.pageSize,total:r.productos.length,onCurrentChange:c.handleCurrentChange,onSizeChange:c.handleSizeChange,style:{"text-align":"center","margin-top":"1%"}},null,8,["page-size","total","onCurrentChange","onSizeChange"])])])]),_:1})]),t(R,{ref:"modalVer"},null,512),t(B,{ref:"modalNuevo",onActualizarTabla:c.obtenerTodos},null,8,["onActualizarTabla"]),t(A,{ref:"modalModificar",onActualizarTabla:c.obtenerTodos},null,8,["onActualizarTabla"]),t(O,{ref:"modalEliminar",onActualizarTabla:c.obtenerTodos},null,8,["onActualizarTabla"])],64)}var ve=z(de,[["render",he]]);export{ve as default};
